

dQdsigma_xx = dQdsigma_(:,1) ; 
dQdsigma_yy = dQdsigma_(:,2) ; 
dQdsigma_xy = dQdsigma_(:,3) ; 
dQdsigma_zz = dQdsigma_(:,4) ; 
ddY = fault_width ; 

% % Der = Gve_ + eta_vp./dt + (P_.*a_.*((ddY.*exp((mu0 + b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2).^(1./2))./L_))))./a_).*((dQdsigma_xx./(3.*dt) + dQdsigma_yy./(3.*dt) - (2.*dQdsigma_zz)./(3.*dt)).*((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)) + (dQdsigma_xx./(3.*dt) - (2.*dQdsigma_yy)./(3.*dt) + dQdsigma_zz./(3.*dt)).*((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)) + (dQdsigma_yy./(3.*dt) - (2.*dQdsigma_xx)./(3.*dt) + dQdsigma_zz./(3.*dt)).*((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)) + (2.*dg_2.*dQdsigma_xy.^2)./dt.^2))./(2.*V0.*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2).^(1./2)) - (b_.*ddY.^2.*exp((mu0 + b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2).^(1./2))./L_))))./a_).*((dQdsigma_xx./(3.*dt) + dQdsigma_yy./(3.*dt) - (2.*dQdsigma_zz)./(3.*dt)).*((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)) + (dQdsigma_xx./(3.*dt) - (2.*dQdsigma_yy)./(3.*dt) + dQdsigma_zz./(3.*dt)).*((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)) + (dQdsigma_yy./(3.*dt) - (2.*dQdsigma_xx)./(3.*dt) + dQdsigma_zz./(3.*dt)).*((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)) + (2.*dg_2.*dQdsigma_xy.^2)./dt.^2))./(L_.*V0.*a_.*(1./dt + (2.*ddY.*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2).^(1./2))./L_))))./((ddY.^2.*exp((2.*mu0 + 2.*b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2).^(1./2))./L_))))./a_).*(((dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_xx)./(3.*dt) - (2.*dg_2.*dQdsigma_yy)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + ((dg_2.*dQdsigma_yy)./(3.*dt) - (2.*dg_2.*dQdsigma_xx)./(3.*dt) + (dg_2.*dQdsigma_zz)./(3.*dt)).^2./2 + (dg_2.^2.*dQdsigma_xy.^2)./dt.^2))./V0.^2 + 1).^(1./2);
% % Der = Gve_ + eta_vp./dt - (P_.*a_.*((ddY.*exp((mu0 + b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2).^(1./2))./L_))))./a_).*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_xx./(3.*dt) + dQdsigma_yy./(3.*dt) - (2.*dQdsigma_zz)./(3.*dt)) + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_xx./(3.*dt) - (2.*dQdsigma_yy)./(3.*dt) + dQdsigma_zz./(3.*dt)) + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_yy./(3.*dt) - (2.*dQdsigma_xx)./(3.*dt) + dQdsigma_zz./(3.*dt)) + (2.*dQdsigma_xy.^2.*dg_2)./dt.^2))./(2.*V0.*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2).^(1./2)) - (b_.*ddY.^2.*exp((mu0 + b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2).^(1./2))./L_))))./a_).*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_xx./(3.*dt) + dQdsigma_yy./(3.*dt) - (2.*dQdsigma_zz)./(3.*dt)) + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_xx./(3.*dt) - (2.*dQdsigma_yy)./(3.*dt) + dQdsigma_zz./(3.*dt)) + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).*(dQdsigma_yy./(3.*dt) - (2.*dQdsigma_xx)./(3.*dt) + dQdsigma_zz./(3.*dt)) + (2.*dQdsigma_xy.^2.*dg_2)./dt.^2))./(L_.*V0.*a_.*(1./dt + (2.*ddY.*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2).^(1./2))./L_))).*(lambda__ - 1))./((ddY.^2.*exp((2.*mu0 + 2.*b_.*log((V0.*(theta_./dt + 1))./(L_.*(1./dt + (2.*ddY.*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2).^(1./2))./L_))))./a_).*(((dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_xx.*dg_2)./(3.*dt) - (2.*dQdsigma_yy.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + ((dQdsigma_yy.*dg_2)./(3.*dt) - (2.*dQdsigma_xx.*dg_2)./(3.*dt) + (dQdsigma_zz.*dg_2)./(3.*dt)).^2./2 + (dQdsigma_xy.^2.*dg_2.^2)./dt.^2))./V0.^2 + 1).^(1./2); 

Der = Gve_ + eta_vp./dt - (P_.*ddY.*dg_2.*exp((mu0 + b_.*log((3.*V0.*(dt + theta_))./(3.*L_ + 2.*3.^(1./2).*ddY.*dt.*((dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./dt.^2).^(1./2))))./a_).*(lambda__ - 1).*(L_.*a_ + (2.*3.^(1./2).*a_.*ddY.*dt.*((dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./dt.^2).^(1./2))./3 - (2.*3.^(1./2).*b_.*ddY.*dt.*((dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./dt.^2).^(1./2))./3).*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./(V0.*dt.*(2.*ddY.*dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2) + 3.^(1./2).*L_.*dt.*((dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./dt.^2).^(1./2)).*((ddY.^2.*dg_2.^2.*exp((2.*mu0 + 2.*b_.*log((3.*V0.*(dt + theta_))./(3.*L_ + 2.*3.^(1./2).*ddY.*dt.*((dg_2.^2.*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./dt.^2).^(1./2))))./a_).*(dQdsigma_xx.^2 - dQdsigma_xx.*dQdsigma_yy - dQdsigma_xx.*dQdsigma_zz + 3.*dQdsigma_xy.^2 + dQdsigma_yy.^2 - dQdsigma_yy.*dQdsigma_zz + dQdsigma_zz.^2))./(3.*V0.^2.*dt.^2) + 1).^(1./2));


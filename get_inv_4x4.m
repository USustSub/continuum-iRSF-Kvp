function [M_inv1_1,M_inv1_2,M_inv1_3,M_inv1_4,M_inv2_1,M_inv2_2,M_inv2_3,M_inv2_4,M_inv3_1,M_inv3_2,M_inv3_3,M_inv3_4,M_inv4_1,M_inv4_2,M_inv4_3,M_inv4_4] = get_inv_4x4 ( M1_1 , M2_1  , M3_1  , M4_1  , ...
          M1_2 , M2_2  , M3_2  , M4_2 , M1_3 , M2_3  , M3_3  , M4_3 , M1_4 , M2_4  , M3_4  , M4_4 ) 
      
M_inv1_1 = (M2_2.*M3_3.*M4_4 - M2_2.*M3_4.*M4_3 - M2_3.*M3_2.*M4_4 + M2_3.*M3_4.*M4_2 + M2_4.*M3_2.*M4_3 - M2_4.*M3_3.*M4_2)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv1_2 = -(M1_2.*M3_3.*M4_4 - M1_2.*M3_4.*M4_3 - M1_3.*M3_2.*M4_4 + M1_3.*M3_4.*M4_2 + M1_4.*M3_2.*M4_3 - M1_4.*M3_3.*M4_2)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv1_3 = (M1_2.*M2_3.*M4_4 - M1_2.*M2_4.*M4_3 - M1_3.*M2_2.*M4_4 + M1_3.*M2_4.*M4_2 + M1_4.*M2_2.*M4_3 - M1_4.*M2_3.*M4_2)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv1_4 = -(M1_2.*M2_3.*M3_4 - M1_2.*M2_4.*M3_3 - M1_3.*M2_2.*M3_4 + M1_3.*M2_4.*M3_2 + M1_4.*M2_2.*M3_3 - M1_4.*M2_3.*M3_2)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);

M_inv2_1 = -(M2_1.*M3_3.*M4_4 - M2_1.*M3_4.*M4_3 - M2_3.*M3_1.*M4_4 + M2_3.*M3_4.*M4_1 + M2_4.*M3_1.*M4_3 - M2_4.*M3_3.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv2_2 = (M1_1.*M3_3.*M4_4 - M1_1.*M3_4.*M4_3 - M1_3.*M3_1.*M4_4 + M1_3.*M3_4.*M4_1 + M1_4.*M3_1.*M4_3 - M1_4.*M3_3.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv2_3 = -(M1_1.*M2_3.*M4_4 - M1_1.*M2_4.*M4_3 - M1_3.*M2_1.*M4_4 + M1_3.*M2_4.*M4_1 + M1_4.*M2_1.*M4_3 - M1_4.*M2_3.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv2_4 = (M1_1.*M2_3.*M3_4 - M1_1.*M2_4.*M3_3 - M1_3.*M2_1.*M3_4 + M1_3.*M2_4.*M3_1 + M1_4.*M2_1.*M3_3 - M1_4.*M2_3.*M3_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);

M_inv3_1 = (M2_1.*M3_2.*M4_4 - M2_1.*M3_4.*M4_2 - M2_2.*M3_1.*M4_4 + M2_2.*M3_4.*M4_1 + M2_4.*M3_1.*M4_2 - M2_4.*M3_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv3_2 = -(M1_1.*M3_2.*M4_4 - M1_1.*M3_4.*M4_2 - M1_2.*M3_1.*M4_4 + M1_2.*M3_4.*M4_1 + M1_4.*M3_1.*M4_2 - M1_4.*M3_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv3_3 = (M1_1.*M2_2.*M4_4 - M1_1.*M2_4.*M4_2 - M1_2.*M2_1.*M4_4 + M1_2.*M2_4.*M4_1 + M1_4.*M2_1.*M4_2 - M1_4.*M2_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv3_4 = -(M1_1.*M2_2.*M3_4 - M1_1.*M2_4.*M3_2 - M1_2.*M2_1.*M3_4 + M1_2.*M2_4.*M3_1 + M1_4.*M2_1.*M3_2 - M1_4.*M2_2.*M3_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);

M_inv4_1 = -(M2_1.*M3_2.*M4_3 - M2_1.*M3_3.*M4_2 - M2_2.*M3_1.*M4_3 + M2_2.*M3_3.*M4_1 + M2_3.*M3_1.*M4_2 - M2_3.*M3_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv4_2 = (M1_1.*M3_2.*M4_3 - M1_1.*M3_3.*M4_2 - M1_2.*M3_1.*M4_3 + M1_2.*M3_3.*M4_1 + M1_3.*M3_1.*M4_2 - M1_3.*M3_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv4_3 = -(M1_1.*M2_2.*M4_3 - M1_1.*M2_3.*M4_2 - M1_2.*M2_1.*M4_3 + M1_2.*M2_3.*M4_1 + M1_3.*M2_1.*M4_2 - M1_3.*M2_2.*M4_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);
M_inv4_4 = (M1_1.*M2_2.*M3_3 - M1_1.*M2_3.*M3_2 - M1_2.*M2_1.*M3_3 + M1_2.*M2_3.*M3_1 + M1_3.*M2_1.*M3_2 - M1_3.*M2_2.*M3_1)./(M1_1.*M2_2.*M3_3.*M4_4 - M1_1.*M2_2.*M3_4.*M4_3 - M1_1.*M2_3.*M3_2.*M4_4 + M1_1.*M2_3.*M3_4.*M4_2 + M1_1.*M2_4.*M3_2.*M4_3 - M1_1.*M2_4.*M3_3.*M4_2 - M1_2.*M2_1.*M3_3.*M4_4 + M1_2.*M2_1.*M3_4.*M4_3 + M1_2.*M2_3.*M3_1.*M4_4 - M1_2.*M2_3.*M3_4.*M4_1 - M1_2.*M2_4.*M3_1.*M4_3 + M1_2.*M2_4.*M3_3.*M4_1 + M1_3.*M2_1.*M3_2.*M4_4 - M1_3.*M2_1.*M3_4.*M4_2 - M1_3.*M2_2.*M3_1.*M4_4 + M1_3.*M2_2.*M3_4.*M4_1 + M1_3.*M2_4.*M3_1.*M4_2 - M1_3.*M2_4.*M3_2.*M4_1 - M1_4.*M2_1.*M3_2.*M4_3 + M1_4.*M2_1.*M3_3.*M4_2 + M1_4.*M2_2.*M3_1.*M4_3 - M1_4.*M2_2.*M3_3.*M4_1 - M1_4.*M2_3.*M3_1.*M4_2 + M1_4.*M2_3.*M3_2.*M4_1);


% % get inverse of 4x4 matrix
% M_inv(1,1) = (M(2,2).*M(3,3).*M(4,4) - M(2,2).*M(3,4).*M(4,3) - M(2,3).*M(3,2).*M(4,4) + M(2,3).*M(3,4).*M(4,2) + M(2,4).*M(3,2).*M(4,3) - M(2,4).*M(3,3).*M(4,2))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(1,2) = -(M(1,2).*M(3,3).*M(4,4) - M(1,2).*M(3,4).*M(4,3) - M(1,3).*M(3,2).*M(4,4) + M(1,3).*M(3,4).*M(4,2) + M(1,4).*M(3,2).*M(4,3) - M(1,4).*M(3,3).*M(4,2))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(1,3) = (M(1,2).*M(2,3).*M(4,4) - M(1,2).*M(2,4).*M(4,3) - M(1,3).*M(2,2).*M(4,4) + M(1,3).*M(2,4).*M(4,2) + M(1,4).*M(2,2).*M(4,3) - M(1,4).*M(2,3).*M(4,2))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(1,4) = -(M(1,2).*M(2,3).*M(3,4) - M(1,2).*M(2,4).*M(3,3) - M(1,3).*M(2,2).*M(3,4) + M(1,3).*M(2,4).*M(3,2) + M(1,4).*M(2,2).*M(3,3) - M(1,4).*M(2,3).*M(3,2))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% 
% M_inv(2,1) = -(M(2,1).*M(3,3).*M(4,4) - M(2,1).*M(3,4).*M(4,3) - M(2,3).*M(3,1).*M(4,4) + M(2,3).*M(3,4).*M(4,1) + M(2,4).*M(3,1).*M(4,3) - M(2,4).*M(3,3).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(2,2) = (M(1,1).*M(3,3).*M(4,4) - M(1,1).*M(3,4).*M(4,3) - M(1,3).*M(3,1).*M(4,4) + M(1,3).*M(3,4).*M(4,1) + M(1,4).*M(3,1).*M(4,3) - M(1,4).*M(3,3).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(2,3) = -(M(1,1).*M(2,3).*M(4,4) - M(1,1).*M(2,4).*M(4,3) - M(1,3).*M(2,1).*M(4,4) + M(1,3).*M(2,4).*M(4,1) + M(1,4).*M(2,1).*M(4,3) - M(1,4).*M(2,3).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(2,4) = (M(1,1).*M(2,3).*M(3,4) - M(1,1).*M(2,4).*M(3,3) - M(1,3).*M(2,1).*M(3,4) + M(1,3).*M(2,4).*M(3,1) + M(1,4).*M(2,1).*M(3,3) - M(1,4).*M(2,3).*M(3,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% 
% M_inv(3,1) = (M(2,1).*M(3,2).*M(4,4) - M(2,1).*M(3,4).*M(4,2) - M(2,2).*M(3,1).*M(4,4) + M(2,2).*M(3,4).*M(4,1) + M(2,4).*M(3,1).*M(4,2) - M(2,4).*M(3,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(3,2) = -(M(1,1).*M(3,2).*M(4,4) - M(1,1).*M(3,4).*M(4,2) - M(1,2).*M(3,1).*M(4,4) + M(1,2).*M(3,4).*M(4,1) + M(1,4).*M(3,1).*M(4,2) - M(1,4).*M(3,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(3,3) = (M(1,1).*M(2,2).*M(4,4) - M(1,1).*M(2,4).*M(4,2) - M(1,2).*M(2,1).*M(4,4) + M(1,2).*M(2,4).*M(4,1) + M(1,4).*M(2,1).*M(4,2) - M(1,4).*M(2,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(3,4) = -(M(1,1).*M(2,2).*M(3,4) - M(1,1).*M(2,4).*M(3,2) - M(1,2).*M(2,1).*M(3,4) + M(1,2).*M(2,4).*M(3,1) + M(1,4).*M(2,1).*M(3,2) - M(1,4).*M(2,2).*M(3,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% 
% M_inv(4,1) = -(M(2,1).*M(3,2).*M(4,3) - M(2,1).*M(3,3).*M(4,2) - M(2,2).*M(3,1).*M(4,3) + M(2,2).*M(3,3).*M(4,1) + M(2,3).*M(3,1).*M(4,2) - M(2,3).*M(3,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(4,2) = (M(1,1).*M(3,2).*M(4,3) - M(1,1).*M(3,3).*M(4,2) - M(1,2).*M(3,1).*M(4,3) + M(1,2).*M(3,3).*M(4,1) + M(1,3).*M(3,1).*M(4,2) - M(1,3).*M(3,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(4,3) = -(M(1,1).*M(2,2).*M(4,3) - M(1,1).*M(2,3).*M(4,2) - M(1,2).*M(2,1).*M(4,3) + M(1,2).*M(2,3).*M(4,1) + M(1,3).*M(2,1).*M(4,2) - M(1,3).*M(2,2).*M(4,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
% M_inv(4,4) = (M(1,1).*M(2,2).*M(3,3) - M(1,1).*M(2,3).*M(3,2) - M(1,2).*M(2,1).*M(3,3) + M(1,2).*M(2,3).*M(3,1) + M(1,3).*M(2,1).*M(3,2) - M(1,3).*M(2,2).*M(3,1))./(M(1,1).*M(2,2).*M(3,3).*M(4,4) - M(1,1).*M(2,2).*M(3,4).*M(4,3) - M(1,1).*M(2,3).*M(3,2).*M(4,4) + M(1,1).*M(2,3).*M(3,4).*M(4,2) + M(1,1).*M(2,4).*M(3,2).*M(4,3) - M(1,1).*M(2,4).*M(3,3).*M(4,2) - M(1,2).*M(2,1).*M(3,3).*M(4,4) + M(1,2).*M(2,1).*M(3,4).*M(4,3) + M(1,2).*M(2,3).*M(3,1).*M(4,4) - M(1,2).*M(2,3).*M(3,4).*M(4,1) - M(1,2).*M(2,4).*M(3,1).*M(4,3) + M(1,2).*M(2,4).*M(3,3).*M(4,1) + M(1,3).*M(2,1).*M(3,2).*M(4,4) - M(1,3).*M(2,1).*M(3,4).*M(4,2) - M(1,3).*M(2,2).*M(3,1).*M(4,4) + M(1,3).*M(2,2).*M(3,4).*M(4,1) + M(1,3).*M(2,4).*M(3,1).*M(4,2) - M(1,3).*M(2,4).*M(3,2).*M(4,1) - M(1,4).*M(2,1).*M(3,2).*M(4,3) + M(1,4).*M(2,1).*M(3,3).*M(4,2) + M(1,4).*M(2,2).*M(3,1).*M(4,3) - M(1,4).*M(2,2).*M(3,3).*M(4,1) - M(1,4).*M(2,3).*M(3,1).*M(4,2) + M(1,4).*M(2,3).*M(3,2).*M(4,1));
